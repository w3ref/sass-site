<!DOCTYPE html> <html class=no-js lang=ru> <head> <meta charset=utf-8> <meta content='IE=edge' http-equiv=X-UA-Compatible> <title>Sass: A Change in Plans for Sass 3.3</title> <meta content='Syntactically Awesome Style Sheets' name=description> <meta content='width=device-width, initial-scale=1' name=viewport> <link href='/feed.xml' rel=alternate type='application/atom+xml'> <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro|Source+Sans+Pro:300,400,600|Source+Serif+Pro" rel=stylesheet /> <link href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" rel=stylesheet /> <link href="/assets/css/sass-dfc221cc.css" rel=stylesheet /> <noscript><link href="/assets/css/noscript-c6723936.css" rel=stylesheet /></noscript> <script>
  (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-PCCZT7S');
</script> </head> <body class='blog blog_a-change-in-plans-for-sass-33'> <noscript> <iframe height=0 src='https://www.googletagmanager.com/ns.html?id=GTM-PCCZT7S' style='display:none;visibility:hidden' width=0></iframe> </noscript> <!--[if lt IE 9]><p class=browserupgrade> You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security. </p><![endif]--> <header class=sl-r-banner itemscope=itemscope itemtype='http://schema.org/WPHeader' role=banner> <div class=sl-c-pop-stripe></div> <div class=sl-l-container> <div class='sl-l-grid sl-l-grid--full sl-l-large-grid--fit sl-l-large-grid--center sl-l-large-grid--gutters'> <p class='sl-l-grid__column sl-r-banner__brand'> <a href="/"><img alt=Sass height=48 src="/assets/img/logos/logo-b6e1ef6e.svg"/> </a></p> <nav aria-label='Site navigation' class='sl-r-banner__navigation sl-l-grid__column sl-l-large-grid sl-l-large-grid__column--auto-size sl-c-list-horizontal-wrapper' itemscope=itemscope itemtype='http://schema.org/SiteNavigationElement' role=navigation> <ul> <li><a href="/install">Установить</a></li> <li><a href="/guide">Изучить Sass</a></li> <li><a href="/blog">Блог</a></li> <li><a href="/documentation">Документация</a></li> <li><a href="/community">Участвовать</a></li> <li><label class=visuallyhidden for=s>Поиск</label><input placeholder='Искать' class=search id=s name=s></li> </ul> </nav> </div> </div> </header> <main class=content id=main-content itemprop=mainContentOfPage role=main> <h1 class=sl-l-container> A Change in Plans for Sass&nbsp;<span class=caps>3.3</span> </h1> <div class='sl-background--white sl-l-container sl-l-section'><p class=sl-c-attribution>Posted 20 December 2013 by Natalie Weizenbaum</p> <p><em>This was originally published as <a href="https://gist.github.com/nex3/8050187">a gist</a>.</em></p> <p>Sass <span class=caps>3.3</span> is coming soon, and along with it several major new features.&nbsp;It supports source maps, SassScript maps, and the use of <code>&amp;</code> in SassScript.&nbsp;In preparation for its release, we&rsquo;ve put out a couple of release candidates to&nbsp;be sure that everything was set and ready to go. Unfortunately, it&nbsp;wasn&rsquo;t.</p> <p>Release candidates often turn up small bugs and inconsistencies in new&nbsp;features, but it&rsquo;s rare that they find anything truly damning. In this case,&nbsp;though, several users noticed an issue with using <code>&amp;</code> in SassScript that rendered&nbsp;a sizable chunk of our plan for that section of <span class=caps>3.3</span> unworkable. It&rsquo;s not a&nbsp;fatal issue, and we think we have a good plan for dealing with it (I&rsquo;ll get to that&nbsp;in a bit), but it is a&nbsp;problem.</p> <h2 id=the-background> <a class=anchor href="#the-background"><span class=visuallyhidden>The Background permalink</span></a>The&nbsp;Background</h2> <p>To understand what&rsquo;s wrong, first you need to understand the reason we&nbsp;decided to make <code>&amp;</code> accessible to SassScript in the first place. One thing users want&nbsp;to do pretty often is to add suffixes to classes. Sometimes this takes the place&nbsp;of nesting selectors, sometimes it&rsquo;s just to make a new class based on the old&nbsp;ones &ndash; the reason doesn&rsquo;t matter much to this discussion. When people tried to&nbsp;do this, they&rsquo;d write something like <code>.foo { &amp;-suffix { ... } }</code>, and it&nbsp;wouldn&rsquo;t work. The reason is that <code>&amp;</code> has the same syntactic function as a type&nbsp;selector (e.g. <code>h1</code>) or a universal selector (<code>*</code>), since it could be replaced by any&nbsp;of those. It doesn&rsquo;t make sense to write <code>*-suffix</code> in a selector, so&nbsp;<code>&amp;-suffix</code> wasn&rsquo;t allowed&nbsp;either.</p> <p>This didn&rsquo;t stop people from wanting to do it, though. So we decided,&nbsp;&ldquo;all right, we already use interpolation (<code>#{}</code>) to support injecting text&nbsp;into selectors &ndash; let&rsquo;s just use that&rdquo;. We decided to add <code>&amp;</code> as a sort of&nbsp;special variable in SassScript that contained a parsed representation of the&nbsp;current selector. You could then mimic <code>&amp;-suffix</code> by doing&nbsp;<code>@at-root #{&amp;}-suffix</code> instead<sup id=fnref1><a href="#fn1">1</a></sup>. Life was peachy, until our intrepid users discovered the&nbsp;problem.</p> <h2 id=the-problem> <a class=anchor href="#the-problem"><span class=visuallyhidden>The Problem permalink</span></a>The&nbsp;Problem</h2> <p>Here&rsquo;s a small snippet of <span class=caps>SCSS</span> that demonstrates the issue. See if you&nbsp;can figure it&nbsp;out:</p> <pre class="highlight scss"><code><span class="nc">.foo</span><span class="o">,</span> <span class="nc">.bar</span> <span class="p">{</span>
  <span class="k">@at-root</span> <span class="si">#{</span><span class="o">&amp;</span><span class="si">}</span><span class="nt">-suffix</span> <span class="p">{</span>
    <span class="nl">color</span><span class="p">:</span> <span class="no">blue</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre> <p>Did you get it? That&rsquo;s right: <code>&amp;</code> in this example is <code>.foo, .bar</code>, which&nbsp;means the selector compiles to <code>.foo, .bar-suffix</code>. Since <code>#{}</code> injects plain&nbsp;old text, there&rsquo;s no chance for Sass to figure out how it should split up&nbsp;the selector.</p> <p><a href="https://github.com/chriseppstein">Chris</a> and I talked and talked about how&nbsp;to fix this. We considered adding a function to add the suffix, but that was&nbsp;too verbose. We considered making <code>&amp;</code> split the compilation of the <span class=caps>CSS</span> rule&nbsp;into several parallel rules which each had a single selector for <code>&amp;</code>, but that&nbsp;was too complicated and fell down in too many edge cases. We eventually&nbsp;concluded that there was no way for SassScript <code>&amp;</code> to cleanly support the use case&nbsp;we designed it&nbsp;for.</p> <h2 id=the-solution> <a class=anchor href="#the-solution"><span class=visuallyhidden>The Solution permalink</span></a>The&nbsp;Solution</h2> <p>We knew we wanted to support the <code>&amp;-suffix</code> use case, and our clever plan&nbsp;for doing so had failed. We put our heads together and discussed, and decided&nbsp;that the best way to support it was the most straightforward: we&rsquo;d just&nbsp;allow <code>&amp;-suffix</code>. This was, after all, what most people tried first when they&nbsp;wanted this behavior, and with the <code>&amp;</code> embedded directly in the selector, we can&nbsp;handle selector lists&nbsp;easily.</p> <p>This means that <strong><code>&amp;-suffix</code> will be supported in Sass <span class=caps>3.3</span></strong>, without&nbsp;needing <code>#{}</code> or <code>@at-root</code>. I&rsquo;ve created <a href="https://github.com/nex3/sass/issues/1055">issue 1055</a> to track it. When&nbsp;compiling these selectors, if the parent selector is one that would result in an&nbsp;invalid selector (e.g. <code>*-suffix</code> or <code>:nth-child(1)-suffix</code>), we&rsquo;ll throw an error&nbsp;there describing why that selector was&nbsp;generated.</p> <p>We are still worried about cases where people write mixins using <code>&amp;-suffix</code>&nbsp;that will then fail to work with certain parent selectors, but in this case&nbsp;we determined that this would be the least of all available&nbsp;evils.</p> <h2 id=the-future-of-in-sassscript> <a class=anchor href="#the-future-of-in-sassscript"><span class=visuallyhidden>The Future of <span class=amp>&amp;</span> in SassScript permalink</span></a>The Future of <code>&amp;</code> in&nbsp;SassScript</h2> <p>In addition to supporting <code>&amp;-suffix</code>, <strong>we&rsquo;ve decided to pull SassScript&nbsp;<code>&amp;</code> from the <span class=caps>3.3</span> release</strong>. Rest assured that it will return &ndash; we recognize that&nbsp;it has other good use cases, and we intend to bring it back for the next&nbsp;big release (likely <span class=caps>3.4</span>). In addition, it will come with a suite of functions&nbsp;for manipulating the selectors it makes available, so it will be more powerful&nbsp;than ever.</p> <p>There are two reasons that we want to hold off on using <code>&amp;</code> in SassScript&nbsp;for now. The first is that we want some time to create the functions that will&nbsp;go along with it and put them through their paces. This may require changing&nbsp;the way it works in various ways, and we don&rsquo;t want to have to&nbsp;make backwards-incompatible changes to do&nbsp;so.</p> <p>The second reason is that we&rsquo;ve spent a fair amount of energy talking up&nbsp;<code>#{&amp;}</code> as a solution to the <code>&amp;-suffix</code> problem. This is our own fault, clearly,&nbsp;but it&rsquo;s true and it&rsquo;s something we need to deal with. Making <code>&amp;-suffix</code> work&nbsp;is great, but if everyone is using <code>#{&amp;}</code> anyway because that&rsquo;s what we told&nbsp;them about a few months ago, then it&rsquo;s not doing everything it can. Having a&nbsp;release where <code>&amp;-suffix</code> works but <code>#{&amp;}</code> doesn&rsquo;t will help guide users towards the&nbsp;best way to solve their problem, before we make the more advanced&nbsp;functionality available.</p> <p><code>@at-root</code> will still be included in Sass&nbsp;<span class=caps>3.3.</span></p> <h2 id=releasing-3-3> <a class=anchor href="#releasing-3-3"><span class=visuallyhidden>Releasing <span class=caps>3.3</span> permalink</span></a>Releasing&nbsp;<span class=caps>3.3</span></h2> <p>Unfortunately, this change will delay the release of <span class=caps>3.3</span>, but hopefully not&nbsp;by too much. I anticipate this being relatively straightforward to implement;&nbsp;the major hurdle was figuring out what to do about it, and that part&rsquo;s done. I&nbsp;plan to devote a large chunk of time to getting <span class=caps>3.3</span> out the door after I come&nbsp;back from winter vacation, so hopefully (no promises) it&rsquo;ll be released some time&nbsp;in January.</p> <div class=footnotes> <hr> <ol> <li id=fn1> <p>The <code>@at-root</code> is necessary since Sass can&rsquo;t reliably figure out&nbsp;whether <code>&amp;</code> was used in the selector like it can when <code>&amp;</code> is used without <code>#{}</code>.&nbsp;<a href="#fnref1">&#8617;</a></p> </li> </ol> </div> </div> <div class=sl-c-alert> <div aria-labelledby=release-nav class='sl-l-container sl-c-list-horizontal-wrapper'> <ul class=sl-l-grid--justify-center> <li id=release-nav> Текущие релизы: </li> <li> <span class=release-name><a href="/dart-sass">Dart Sass</a>&#32;<a href="https://github.com/sass/dart-sass/releases/tag/1.38.2">1.38.2</a></span> </li> <li> <span class=release-name><a href="/libsass">LibSass</a>&#32;<a href="https://github.com/sass/libsass/releases/tag/3.6.5">3.6.5</a></span> </li> <li> <span class=release-name><a href="/ruby-sass">Ruby Sass</a><span aria-label=coffin role=presentation> &#32; ⚰ </span></span> </li> <li class='sl-l-grid__column sl-l-large-grid__column--auto-size'> <a href="/implementation">Руководство по внедрению</a> </li> </ul> </div> </div> </main> <footer class='site-footer contentinfo' itemscope=itemscope itemtype='http://schema.org/WPFooter' role=contentinfo> <div class='sl-l-container sl-l-section'> <div class='sl-l-grid sl-l-grid--full sl-l-large-grid--fit sl-l-large-grid--center sl-l-large-grid--gutters'> <div class=sl-l-grid__column> <p>Sass &copy; 2006&ndash;2021 команда Sass и многочисленные участники. Он доступен для использования и модификации по <a href="https://github.com/sass/dart-sass/blob/master/LICENSE">лицензии MIT&nbsp;</a>.</p> <nav class=sl-c-list-horizontal-wrapper> <ul> <li><a href="https://github.com/sass">Sass на GitHub</a></li> <li><a href="https://github.com/w3ref/sass-site">Исходный код веб-сайта</a></li> <li><a href="/styleguide">Руководство по стилю</a></li> <li><a href="/community-guidelines">Рекомендации сообщества</a></li> </ul> </nav> </div> <div class='sl-l-grid__column sl-l-large-grid__column--auto-size sl-l-large-grid--justify-right'> <a class=twitter-follow-button data-show-count=false data-size=large href='https://twitter.com/SassCSS'> Следите за @SassCSS </a> <script>
  !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');
</script> </div> </div> </div> </footer> <script src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script> <script>
  docsearch({
    apiKey: 'a409ff5d6a2476083c1a8dd1f8c04ec5',
    indexName: 'sass-lang',
    inputSelector: 'input.search',
    transformData: function(hits) {
      var domain = window.location.origin + "/";
      hits.forEach(function(hit) {
        if (!hit.url.startsWith(domain)) {
          hit.url = hit.url.replace(/^https?:\/\/[^\/]+\//, domain);
        }
      });
      return hits;
    },
    debug: false
  });
</script> <script src="/assets/js/sass-b8cb06ab.js"></script> </body> </html>